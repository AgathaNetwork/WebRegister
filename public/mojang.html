<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自助注册 | Agatha纯净生存</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="js/bootstrap.bundle.min.js"></script>

</head>
<body>
    
    <nav class="navbar navbar-light" style="background-color: #e3f2fd;">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">
                自助注册
            </a>
        </div>
    </nav>

    <div class="container" style="margin-top:1rem" id="IndexContainer">
      <div class="row">
        <div class="col">
          <h3>正版验证</h3>
          <div class="progress">
            <div class="progress-bar" role="progressbar" style="width: 20%" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">20%</div>
          </div>
      </div>
      </div>
      <div class="shadow-sm row mt-4">
        <div class="col">
            <div class="alert alert-primary" role="alert">
              Agatha纯净生存与Mojang以及微软公司没有从属关系
  </div>
      </div>
      </div>

        <div class="shadow-sm row" style="margin-top:1rem">
          <div class="col" style="text-align: center;">
            <div class="input-group mb-3" >
              <span class="input-group-text" id="basic-addon1">玩家名</span>
              <input type="text" class="form-control" placeholder="请输入玩家名，区分大小写" aria-label="Username" aria-describedby="basic-addon1" id="usernameInput">
              
            </div>
            
            <button class="btn btn-primary mb-2" type="button" id="submitBtn">
              <span id="spinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
              <span id="btnText">提交</span>
            </button>
          </div>
        </div>
    </div>

    <script>
      document.getElementById('submitBtn').addEventListener('click', function() {
        const username = document.getElementById('usernameInput').value.trim();
        if (!username) {
          alert('请输入玩家名');
          return;
        }

        // Show spinner and disable button
        const spinner = document.getElementById('spinner');
        const btnText = document.getElementById('btnText');
        const submitBtn = document.getElementById('submitBtn');
        
        spinner.style.display = 'inline-block';
        btnText.textContent = '加载中...';
        submitBtn.disabled = true;

        // Make GET request
        fetch(`https://api-minecraft.agatha.org.cn/uuid_svc?name=${encodeURIComponent(username)}`)
          .then(response => response.json())
          .then(data => {
            // Hide spinner and enable button
            spinner.style.display = 'none';
            btnText.textContent = '提交';
            submitBtn.disabled = false;
            
            // Check if response has required fields
            if (data.id && data.name) {
              // Redirect will be implemented here later
              // https://login.live.com/oauth20_authorize.srf?client_id=b5f2d80e-6259-478a-83b0-42321c9d1c7a&scope=XboxLive.SignIn&redirect_uri=https%3a%2f%2fregister.agatha.org.cn%2ffinish_mojang.html&response_type=code&response_mode=form_post&prompt=login&uaid=78b0a167093f42bcbc230477f2cd635f&msproxy=1&issuer=mso&tenant=consumers&ui_locales=zh-CN&epct=PAQABDgEAAABVrSpeuWamRam2jAF1XRQEG1oLwD5jmY3b105d3svB1OzPryfVR-wAigJjzY_X2u-uZ1OzEbswu-5QBVANwQHWKnFo5k4CUZQ-olSkkXZS69fR9YCtSUUYEMpFLsSgAzZaourncDRw-LCAHJhBKS6ZDksrm5cbIQqjHx6NcWf1GHIy6bpzplyu2RuuCmnlSfXfqL-JWt87Y1Hnpoj59Ah_N8Xk6qQB5d_8qyJisMxvoSAA&jshs=0#
              window.location.href = 'https://login.live.com/oauth20_authorize.srf?client_id=b5f2d80e-6259-478a-83b0-42321c9d1c7a&scope=XboxLive.SignIn&redirect_uri=https%3a%2f%2fregister.agatha.org.cn%2ffinish_mojang.html&response_type=code&response_mode=form_post&prompt=login&uaid=78b0a167093f42bcbc230477f2cd635f&msproxy=1&issuer=mso&tenant=consumers&ui_locales=zh-CN&epct=PAQABDgEAAABVrSpeuWamRam2jAF1XRQEG1oLwD5jmY3b105d3svB1OzPryfVR-wAigJjzY_X2u-uZ1OzEbswu-5QBVANwQHWKnFo5k4CUZQ-olSkkXZS69fR9YCtSUUYEMpFLsSgAzZaourncDRw-LCAHJhBKS6ZDksrm5cbIQqjHx6NcWf1GHIy6bpzplyu2RuuCmnlSfXfqL-JWt87Y1Hnpoj59Ah_N8Xk6qQB5d_8qyJisMxvoSAA&jshs=0#'
            } else {
              alert('未找到该玩家信息');
            }
          })
          .catch(error => {
            // Hide spinner and enable button
            spinner.style.display = 'none';
            btnText.textContent = '提交';
            submitBtn.disabled = false;
            
            console.error('Error:', error);
            alert('请求失败，请稍后重试');
          });
      });
    </script>
</body>
</html>
